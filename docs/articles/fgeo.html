<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Get started • fgeo</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/united/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><!-- docsearch --><script src="../docsearch.js"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.css">
<link href="../docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script><link href="../extra.css" rel="stylesheet">
<script src="../extra.js"></script><meta property="og:title" content="Get started">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">fgeo</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/fgeo.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/questions-and-answers.html">Questions and Answers</a>
    </li>
    <li>
      <a href="../articles/quick-search.html">Quick Search</a>
    </li>
    <li>
      <a href="../articles/siteonly/eda.html">Exploratory Data Analysis</a>
    </li>
    <li>
      <a href="../articles/siteonly/full-reference.html">Full Reference</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Community
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="https://rstudio.cloud/project/43852">Try fgeo in rstudio.cloud</a>
    </li>
    <li>
      <a href="https://github.com/forestgeo/learn/issues">Resources</a>
    </li>
    <li>
      <a href="https://github.com/forestgeo/forum/issues">Questions and Answers</a>
    </li>
    <li>
      <a href="https://fgeo.netlify.com/">Blog</a>
    </li>
  </ul>
</li>
<li>
  <a href="https://github.com/maurolepore">
    <span class="fa fa-gavel"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/forestgeo/fgeo">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
<form class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
</div>
      </form>
      
    </div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Get started</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/forestgeo/fgeo/blob/master/vignettes/fgeo.Rmd"><code>vignettes/fgeo.Rmd</code></a></small>
      <div class="hidden name"><code>fgeo.Rmd</code></div>

    </div>

    
    
<p>This article shows some of the key features of <strong>fgeo</strong> applied to an exploratory data analysis. For a deeper and general approach to exploratory data analysis see <a href="http://r4ds.had.co.nz/exploratory-data-analysis.html">this book section</a>. A version adapted for ForestGEO is available <a href="https://forestgeo.github.io/fgeo/articles/siteonly/eda.html">here</a>.</p>
<div id="packages" class="section level2">
<h2 class="hasAnchor">
<a href="#packages" class="anchor"></a>Packages</h2>
<p>In every new R session you need to “open” <strong>fgeo</strong> with <code>library</code>().</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw">library</span>(fgeo)</a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="co">#&gt; -- Attaching packages -------------------------------------------------------------- fgeo 0.0.0.9000 --</span></a>
<a class="sourceLine" id="cb1-3" data-line-number="3"><span class="co">#&gt; v bciex           0.0.0.9000     v fgeo.demography 0.0.0.9000</span></a>
<a class="sourceLine" id="cb1-4" data-line-number="4"><span class="co">#&gt; v fgeo.abundance  0.0.0.9004     v fgeo.habitat    0.0.0.9006</span></a>
<a class="sourceLine" id="cb1-5" data-line-number="5"><span class="co">#&gt; v fgeo.base       0.0.0.9001     v fgeo.map        0.0.0.9204</span></a>
<a class="sourceLine" id="cb1-6" data-line-number="6"><span class="co">#&gt; v fgeo.data       0.0.0.9002     v fgeo.tool       0.0.0.9003</span></a>
<a class="sourceLine" id="cb1-7" data-line-number="7"><span class="co">#&gt; -- Conflicts ---------------------------------------------------------------------- fgeo_conflicts() --</span></a>
<a class="sourceLine" id="cb1-8" data-line-number="8"><span class="co">#&gt; x fgeo.tool::filter() masks stats::filter()</span></a></code></pre></div>
</div>
<div id="data" class="section level2">
<h2 class="hasAnchor">
<a href="#data" class="anchor"></a>Data</h2>
<p>You may load your own data. Here I’ll use data from the <strong>fgeo.data</strong> package – which comes with <strong>fgeo</strong>.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="kw">str</span>(<span class="kw"><a href="../reference/fgeo_index.html">fgeo_index_datasets</a></span>())</a>
<a class="sourceLine" id="cb2-2" data-line-number="2"><span class="co">#&gt; 'data.frame':    48 obs. of  2 variables:</span></a>
<a class="sourceLine" id="cb2-3" data-line-number="3"><span class="co">#&gt;  $ package: chr  "bciex" "bciex" "bciex" "bciex" ...</span></a>
<a class="sourceLine" id="cb2-4" data-line-number="4"><span class="co">#&gt;  $ dataset: chr  "bci_elevation" "bci_habitat" "bci_mat" "bci_plotdim" ...</span></a></code></pre></div>
<p>I’ll use a dataset of stems censused in one hectare in the forest plot Luquillo, Puerto Rico (<a href="https://forestgeo.si.edu/sites/north-america/luquillo" class="uri">https://forestgeo.si.edu/sites/north-america/luquillo</a>).</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1">stem &lt;-<span class="st"> </span>luquillo_stem_1ha</a>
<a class="sourceLine" id="cb3-2" data-line-number="2"><span class="kw">str</span>(stem)</a>
<a class="sourceLine" id="cb3-3" data-line-number="3"><span class="co">#&gt; Classes 'tbl_df', 'tbl' and 'data.frame':    72618 obs. of  19 variables:</span></a>
<a class="sourceLine" id="cb3-4" data-line-number="4"><span class="co">#&gt;  $ treeID   : int  46 47 47 47 47 47 47 47 47 47 ...</span></a>
<a class="sourceLine" id="cb3-5" data-line-number="5"><span class="co">#&gt;  $ stemID   : int  46 47 48 49 50 51 52 53 54 55 ...</span></a>
<a class="sourceLine" id="cb3-6" data-line-number="6"><span class="co">#&gt;  $ tag      : chr  "100001" "100008" "100008" "100008" ...</span></a>
<a class="sourceLine" id="cb3-7" data-line-number="7"><span class="co">#&gt;  $ StemTag  : chr  "100001" "100002" "100003" "100004" ...</span></a>
<a class="sourceLine" id="cb3-8" data-line-number="8"><span class="co">#&gt;  $ sp       : chr  "PSYBRA" "PSYBRA" "PSYBRA" "PSYBRA" ...</span></a>
<a class="sourceLine" id="cb3-9" data-line-number="9"><span class="co">#&gt;  $ quadrat  : chr  "921" "921" "921" "921" ...</span></a>
<a class="sourceLine" id="cb3-10" data-line-number="10"><span class="co">#&gt;  $ gx       : num  164 165 165 165 165 ...</span></a>
<a class="sourceLine" id="cb3-11" data-line-number="11"><span class="co">#&gt;  $ gy       : num  416 416 416 416 416 ...</span></a>
<a class="sourceLine" id="cb3-12" data-line-number="12"><span class="co">#&gt;  $ MeasureID: int  46 47 48 49 50 51 52 53 54 55 ...</span></a>
<a class="sourceLine" id="cb3-13" data-line-number="13"><span class="co">#&gt;  $ CensusID : int  1 1 1 1 1 1 1 1 1 1 ...</span></a>
<a class="sourceLine" id="cb3-14" data-line-number="14"><span class="co">#&gt;  $ dbh      : num  22.6 15 12.8 10.9 13.4 10.8 15.4 16.6 13.3 11.1 ...</span></a>
<a class="sourceLine" id="cb3-15" data-line-number="15"><span class="co">#&gt;  $ pom      : chr  "1.3" "1.3" "1.3" "1.3" ...</span></a>
<a class="sourceLine" id="cb3-16" data-line-number="16"><span class="co">#&gt;  $ hom      : num  1.3 1.3 1.3 1.3 1.3 1.3 1.3 1.3 1.3 1.3 ...</span></a>
<a class="sourceLine" id="cb3-17" data-line-number="17"><span class="co">#&gt;  $ ExactDate: num  8610 8610 8610 8610 8610 8610 8610 8610 8610 8610 ...</span></a>
<a class="sourceLine" id="cb3-18" data-line-number="18"><span class="co">#&gt;  $ DFstatus : chr  "alive" "alive" "alive" "alive" ...</span></a>
<a class="sourceLine" id="cb3-19" data-line-number="19"><span class="co">#&gt;  $ codes    : chr  "MAIN;A" "SPROUT;A" "SPROUT;A" "SPROUT;A" ...</span></a>
<a class="sourceLine" id="cb3-20" data-line-number="20"><span class="co">#&gt;  $ countPOM : num  1 1 1 1 1 1 1 1 1 1 ...</span></a>
<a class="sourceLine" id="cb3-21" data-line-number="21"><span class="co">#&gt;  $ status   : chr  "A" "A" "A" "A" ...</span></a>
<a class="sourceLine" id="cb3-22" data-line-number="22"><span class="co">#&gt;  $ date     : num  NA NA NA NA NA NA NA NA NA NA ...</span></a></code></pre></div>
<p>For a description of the columns see <code>?data_dictionary</code>.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="kw">str</span>(data_dictionary)</a>
<a class="sourceLine" id="cb4-2" data-line-number="2"><span class="co">#&gt; Classes 'tbl_df', 'tbl' and 'data.frame':    242 obs. of  3 variables:</span></a>
<a class="sourceLine" id="cb4-3" data-line-number="3"><span class="co">#&gt;  $ table      : chr  "Census" "Census" "Census" "Census" ...</span></a>
<a class="sourceLine" id="cb4-4" data-line-number="4"><span class="co">#&gt;  $ column     : chr  "CensusID" "PlotID" "PlotCensusNumber" "StartDate" ...</span></a>
<a class="sourceLine" id="cb4-5" data-line-number="5"><span class="co">#&gt;  $ description: chr  "Primary key, an integer  automatically generated to uniquely identify a census." "Foreign Key to Site table." "Integer census number for an individual plot, 1=first census, 2=second census, etc. If there are more than one "| __truncated__ "Date on which the first measurement of the census was taken." ...</span></a>
<a class="sourceLine" id="cb4-6" data-line-number="6"></a>
<a class="sourceLine" id="cb4-7" data-line-number="7">cols &lt;-<span class="st"> </span><span class="kw">names</span>(stem)</a>
<a class="sourceLine" id="cb4-8" data-line-number="8"><span class="kw">subset</span>(data_dictionary, column <span class="op">%in%</span><span class="st"> </span>cols)</a>
<a class="sourceLine" id="cb4-9" data-line-number="9"><span class="co">#&gt; # A tibble: 20 x 3</span></a>
<a class="sourceLine" id="cb4-10" data-line-number="10"><span class="co">#&gt;    table                 column    description                            </span></a>
<a class="sourceLine" id="cb4-11" data-line-number="11"><span class="co">#&gt;    &lt;chr&gt;                 &lt;chr&gt;     &lt;chr&gt;                                  </span></a>
<a class="sourceLine" id="cb4-12" data-line-number="12"><span class="co">#&gt;  1 Census                CensusID  Primary key, an integer  automatically~</span></a>
<a class="sourceLine" id="cb4-13" data-line-number="13"><span class="co">#&gt;  2 CensusQuadrat         CensusID  Foreign Key to Census table.           </span></a>
<a class="sourceLine" id="cb4-14" data-line-number="14"><span class="co">#&gt;  3 DataCollection        CensusID  Foreign Key to Census table.           </span></a>
<a class="sourceLine" id="cb4-15" data-line-number="15"><span class="co">#&gt;  4 DBH                   CensusID  Foreign Key to Census table.           </span></a>
<a class="sourceLine" id="cb4-16" data-line-number="16"><span class="co">#&gt;  5 DBH                   ExactDate Date on which the measurement was take~</span></a>
<a class="sourceLine" id="cb4-17" data-line-number="17"><span class="co">#&gt;  6 DBHAttributes         CensusID  Foreign Key to Census table.           </span></a>
<a class="sourceLine" id="cb4-18" data-line-number="18"><span class="co">#&gt;  7 Measurement           MeasureID Primary key, an integer  automatically~</span></a>
<a class="sourceLine" id="cb4-19" data-line-number="19"><span class="co">#&gt;  8 Measurement           CensusID  Foreign Key to Census table.           </span></a>
<a class="sourceLine" id="cb4-20" data-line-number="20"><span class="co">#&gt;  9 Measurement           ExactDate "Date on which measurement has been do~</span></a>
<a class="sourceLine" id="cb4-21" data-line-number="21"><span class="co">#&gt; 10 MeasurementAttributes MeasureID Foreign Key to Measurement table.      </span></a>
<a class="sourceLine" id="cb4-22" data-line-number="22"><span class="co">#&gt; 11 MeasurementAttributes CensusID  Foreign Key to Census table.           </span></a>
<a class="sourceLine" id="cb4-23" data-line-number="23"><span class="co">#&gt; 12 RemeasAttribs         CensusID  Foreign Key to Census table.           </span></a>
<a class="sourceLine" id="cb4-24" data-line-number="24"><span class="co">#&gt; 13 Remeasurement         CensusID  Foreign Key to  Census table.          </span></a>
<a class="sourceLine" id="cb4-25" data-line-number="25"><span class="co">#&gt; 14 Remeasurement         ExactDate "Date of remeasurement.  (format is yy~</span></a>
<a class="sourceLine" id="cb4-26" data-line-number="26"><span class="co">#&gt; 15 SpeciesInventory      CensusID  Foreign Key to  Census table.          </span></a>
<a class="sourceLine" id="cb4-27" data-line-number="27"><span class="co">#&gt; 16 Stem                  StemTag   The stem tag used in the field to iden~</span></a>
<a class="sourceLine" id="cb4-28" data-line-number="28"><span class="co">#&gt; 17 TreeAttributes        CensusID  Foreign Key to  Census table.          </span></a>
<a class="sourceLine" id="cb4-29" data-line-number="29"><span class="co">#&gt; 18 ViewFullTable         StemTag   The stem tag used in the field to iden~</span></a>
<a class="sourceLine" id="cb4-30" data-line-number="30"><span class="co">#&gt; 19 ViewFullTable         CensusID  Foreign Key to  Census table.          </span></a>
<a class="sourceLine" id="cb4-31" data-line-number="31"><span class="co">#&gt; 20 ViewFullTable         ExactDate Date on which the measurement was take~</span></a></code></pre></div>
<p>This dataset comes with multiple censuses. I’ll pick only the latest one.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="kw">unique</span>(stem<span class="op">$</span>CensusID)</a>
<a class="sourceLine" id="cb5-2" data-line-number="2"><span class="co">#&gt; [1] 1 2 3 4 5 6</span></a>
<a class="sourceLine" id="cb5-3" data-line-number="3"></a>
<a class="sourceLine" id="cb5-4" data-line-number="4"><span class="co"># `pick_top()` with n &lt; 0 from the bottom rank of `var`. See ?pick_top().</span></a>
<a class="sourceLine" id="cb5-5" data-line-number="5">stem6 &lt;-<span class="st"> </span><span class="kw">pick_top</span>(stem, <span class="dt">var =</span> CensusID, <span class="dt">n =</span> <span class="dv">-1</span>)</a>
<a class="sourceLine" id="cb5-6" data-line-number="6"><span class="kw">unique</span>(stem6<span class="op">$</span>CensusID)</a>
<a class="sourceLine" id="cb5-7" data-line-number="7"><span class="co">#&gt; [1] 6</span></a></code></pre></div>
</div>
<div id="exploring-the-distribution-of-status-and-tree-diameter" class="section level2">
<h2 class="hasAnchor">
<a href="#exploring-the-distribution-of-status-and-tree-diameter" class="anchor"></a>Exploring the distribution of status and tree diameter</h2>
<p>Two columns that are commonly useful in ForestGEO datasets are <code>status</code> and <code>dbh</code> (diameter at breast height). Let’s begin by understanding what type of variables they are. For this, base R provides useful functions.</p>
<p><code>status</code> is a categorical variable.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="kw">summary</span>(stem6<span class="op">$</span>status)</a>
<a class="sourceLine" id="cb6-2" data-line-number="2"><span class="co">#&gt;    Length     Class      Mode </span></a>
<a class="sourceLine" id="cb6-3" data-line-number="3"><span class="co">#&gt;     12103 character character</span></a></code></pre></div>
<p>We can count the number of observations in each category with <code>table()</code>, then visualize the result with <code>barplot()</code>.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1">by_category &lt;-<span class="st"> </span><span class="kw">table</span>(stem6<span class="op">$</span>status)</a>
<a class="sourceLine" id="cb7-2" data-line-number="2"><span class="kw">barplot</span>(by_category)</a></code></pre></div>
<p><img src="fgeo_files/figure-html/unnamed-chunk-7-1.png" width="700"></p>
<p><code>dbh</code> is a continuous numeric variable.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1"><span class="kw">summary</span>(stem6<span class="op">$</span>dbh)</a>
<a class="sourceLine" id="cb8-2" data-line-number="2"><span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's </span></a>
<a class="sourceLine" id="cb8-3" data-line-number="3"><span class="co">#&gt;   10.00   21.77   56.00   93.71  142.00 1405.00    9539</span></a></code></pre></div>
<p>(Note the missing values (<code>NA</code>’s).)</p>
<p>And we can visualize its distribution with <code>hist()</code>.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1"><span class="kw">hist</span>(stem6<span class="op">$</span>dbh)</a></code></pre></div>
<p><img src="fgeo_files/figure-html/unnamed-chunk-9-1.png" width="700"></p>
<p>Unfortunately <code>hist()</code> dropped missing values silently. But we can better understand how missing values of <code>dbh</code> relate to <code>status</code> by extracting only the columns <code>dbh</code> and <code>status</code>, and picking only the rows where <code>dbh</code> is missing.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1">dbh_status &lt;-<span class="st"> </span>stem6[<span class="kw">c</span>(<span class="st">"dbh"</span>, <span class="st">"status"</span>)]</a>
<a class="sourceLine" id="cb10-2" data-line-number="2">missing &lt;-<span class="st"> </span><span class="kw">subset</span>(dbh_status, <span class="kw">is.na</span>(dbh))</a>
<a class="sourceLine" id="cb10-3" data-line-number="3"><span class="kw">unique</span>(missing)</a>
<a class="sourceLine" id="cb10-4" data-line-number="4"><span class="co">#&gt; # A tibble: 3 x 2</span></a>
<a class="sourceLine" id="cb10-5" data-line-number="5"><span class="co">#&gt;     dbh status</span></a>
<a class="sourceLine" id="cb10-6" data-line-number="6"><span class="co">#&gt;   &lt;dbl&gt; &lt;chr&gt; </span></a>
<a class="sourceLine" id="cb10-7" data-line-number="7"><span class="co">#&gt; 1    NA D     </span></a>
<a class="sourceLine" id="cb10-8" data-line-number="8"><span class="co">#&gt; 2    NA G     </span></a>
<a class="sourceLine" id="cb10-9" data-line-number="9"><span class="co">#&gt; 3    NA A</span></a></code></pre></div>
<p>Another approach is to count missing values.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1">missing &lt;-<span class="st"> </span><span class="kw">transform</span>(stem6, <span class="dt">na =</span> <span class="kw">ifelse</span>(<span class="kw">is.na</span>(dbh), <span class="ot">TRUE</span>, <span class="ot">FALSE</span>))</a>
<a class="sourceLine" id="cb11-2" data-line-number="2"><span class="kw">table</span>(missing<span class="op">$</span>na, missing<span class="op">$</span>status)</a>
<a class="sourceLine" id="cb11-3" data-line-number="3"><span class="co">#&gt;        </span></a>
<a class="sourceLine" id="cb11-4" data-line-number="4"><span class="co">#&gt;            A    D    G</span></a>
<a class="sourceLine" id="cb11-5" data-line-number="5"><span class="co">#&gt;   FALSE 2564    0    0</span></a>
<a class="sourceLine" id="cb11-6" data-line-number="6"><span class="co">#&gt;   TRUE     4 5416 4119</span></a></code></pre></div>
<p>We learn that <code>dbh</code> is missing where a tree is dead (<code>status = A</code>) or gone (<code>status = G</code>). This makes sense and, depending on the type of analysis we want to do, we may want to keep or remove missing values.</p>
</div>
<div id="determining-tree-status-based-on-stem-status" class="section level2">
<h2 class="hasAnchor">
<a href="#determining-tree-status-based-on-stem-status" class="anchor"></a>Determining tree status based on stem status</h2>
<p>Now that we understand out data are read to clean it, for example, by picking alive trees only. At ForestGEO, working with <code>status</code> is so common that <strong>fgeo</strong> provides a specialized function.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1"><span class="kw"><a href="../reference/fgeo_help.html">fgeo_help</a></span>(<span class="st">"status"</span>)</a></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1">fgeo_funs &lt;-<span class="st"> </span><span class="kw"><a href="../reference/fgeo_index.html">fgeo_index_functions</a></span>()</a>
<a class="sourceLine" id="cb13-2" data-line-number="2"><span class="kw">subset</span>(fgeo_funs, <span class="kw">grepl</span>(<span class="st">"status"</span>, fun))</a>
<a class="sourceLine" id="cb13-3" data-line-number="3"><span class="co">#&gt;       package             fun</span></a>
<a class="sourceLine" id="cb13-4" data-line-number="4"><span class="co">#&gt; 39  fgeo.base     drop_status</span></a>
<a class="sourceLine" id="cb13-5" data-line-number="5"><span class="co">#&gt; 61  fgeo.base     pick_status</span></a>
<a class="sourceLine" id="cb13-6" data-line-number="6"><span class="co">#&gt; 113 fgeo.tool add_status_tree</span></a>
<a class="sourceLine" id="cb13-7" data-line-number="7"><span class="co">#&gt; 138 fgeo.tool   filter_status</span></a></code></pre></div>
<p>In <code>stem6</code>, the variable <code>status</code> records the status of each individual stem. How can we determine the status of a tree based on the status of each of its stems? That is the job of <code>add_status_tree()</code>.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1">stem6 &lt;-<span class="st"> </span><span class="kw">add_status_tree</span>(stem6, <span class="dt">status_a =</span> <span class="st">"A"</span>, <span class="dt">status_d =</span> <span class="st">"D"</span>)</a>
<a class="sourceLine" id="cb14-2" data-line-number="2">alive_trees &lt;-<span class="st"> </span><span class="kw">subset</span>(stem6, status_tree <span class="op">==</span><span class="st"> "A"</span>)</a>
<a class="sourceLine" id="cb14-3" data-line-number="3"></a>
<a class="sourceLine" id="cb14-4" data-line-number="4"><span class="co"># Note that alive trees may have some missing, gone or dead stems</span></a>
<a class="sourceLine" id="cb14-5" data-line-number="5">some_cols &lt;-<span class="st"> </span><span class="kw">c</span>( <span class="st">"treeID"</span>, <span class="st">"status_tree"</span>, <span class="st">"stemID"</span>, <span class="st">"status"</span>)</a>
<a class="sourceLine" id="cb14-6" data-line-number="6">example_tree &lt;-<span class="st"> </span><span class="dv">46</span></a>
<a class="sourceLine" id="cb14-7" data-line-number="7"><span class="kw">subset</span>(alive_trees, treeID <span class="op">==</span><span class="st"> </span>example_tree, some_cols)</a>
<a class="sourceLine" id="cb14-8" data-line-number="8"><span class="co">#&gt; # A tibble: 2 x 4</span></a>
<a class="sourceLine" id="cb14-9" data-line-number="9"><span class="co">#&gt;   treeID status_tree stemID status</span></a>
<a class="sourceLine" id="cb14-10" data-line-number="10"><span class="co">#&gt;    &lt;int&gt; &lt;chr&gt;        &lt;int&gt; &lt;chr&gt; </span></a>
<a class="sourceLine" id="cb14-11" data-line-number="11"><span class="co">#&gt; 1     46 A               46 D     </span></a>
<a class="sourceLine" id="cb14-12" data-line-number="12"><span class="co">#&gt; 2     46 A           114033 G</span></a></code></pre></div>
</div>
<div id="picking-a-dbh-range" class="section level2">
<h2 class="hasAnchor">
<a href="#picking-a-dbh-range" class="anchor"></a>Picking a <code>dbh</code> range</h2>
<p>Another very common task when working with ForestGEO data is to pick stems of a particular <code>dbh</code> range.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" data-line-number="1"><span class="kw"><a href="../reference/fgeo_help.html">fgeo_help</a></span>(<span class="st">"dbh"</span>)</a></code></pre></div>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1"><span class="kw">subset</span>(fgeo_funs, <span class="kw">grepl</span>(<span class="st">"dbh"</span>, fun))</a>
<a class="sourceLine" id="cb16-2" data-line-number="2"><span class="co">#&gt;      package            fun</span></a>
<a class="sourceLine" id="cb16-3" data-line-number="3"><span class="co">#&gt; 56 fgeo.base   pick_dbh_max</span></a>
<a class="sourceLine" id="cb16-4" data-line-number="4"><span class="co">#&gt; 57 fgeo.base   pick_dbh_min</span></a>
<a class="sourceLine" id="cb16-5" data-line-number="5"><span class="co">#&gt; 58 fgeo.base  pick_dbh_over</span></a>
<a class="sourceLine" id="cb16-6" data-line-number="6"><span class="co">#&gt; 59 fgeo.base pick_dbh_under</span></a></code></pre></div>
<p>Pick stems of 10 mm or more.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" data-line-number="1">ten_plus &lt;-<span class="st"> </span><span class="kw">pick_dbh_min</span>(alive_trees, <span class="dv">10</span>)</a>
<a class="sourceLine" id="cb17-2" data-line-number="2"><span class="kw">range</span>(ten_plus<span class="op">$</span>dbh, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb17-3" data-line-number="3"><span class="co">#&gt; [1]   10 1405</span></a></code></pre></div>
</div>
<div id="dropping-missing-values" class="section level2">
<h2 class="hasAnchor">
<a href="#dropping-missing-values" class="anchor"></a>Dropping missing values</h2>
<p>Drop missing values of <code>dbh</code> with an informative warning.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" data-line-number="1">non_missing &lt;-<span class="st"> </span><span class="kw">drop_if_na</span>(ten_plus, <span class="st">"dbh"</span>)</a>
<a class="sourceLine" id="cb18-2" data-line-number="2"><span class="co">#&gt; Warning: Dropping 5261 rows with missing `dbh` values.</span></a></code></pre></div>
</div>
<div id="calculating-abundance" class="section level2">
<h2 class="hasAnchor">
<a href="#calculating-abundance" class="anchor"></a>Calculating abundance</h2>
<p>Calculate the total abundance of stems and trees.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" data-line-number="1"><span class="kw">abundance_stem</span>(non_missing)</a>
<a class="sourceLine" id="cb19-2" data-line-number="2"><span class="co">#&gt; # A tibble: 1 x 1</span></a>
<a class="sourceLine" id="cb19-3" data-line-number="3"><span class="co">#&gt;       n</span></a>
<a class="sourceLine" id="cb19-4" data-line-number="4"><span class="co">#&gt;   &lt;int&gt;</span></a>
<a class="sourceLine" id="cb19-5" data-line-number="5"><span class="co">#&gt; 1  2564</span></a>
<a class="sourceLine" id="cb19-6" data-line-number="6"></a>
<a class="sourceLine" id="cb19-7" data-line-number="7"><span class="kw">abundance_tree</span>(non_missing)</a>
<a class="sourceLine" id="cb19-8" data-line-number="8"><span class="co">#&gt; # A tibble: 1 x 1</span></a>
<a class="sourceLine" id="cb19-9" data-line-number="9"><span class="co">#&gt;       n</span></a>
<a class="sourceLine" id="cb19-10" data-line-number="10"><span class="co">#&gt;   &lt;int&gt;</span></a>
<a class="sourceLine" id="cb19-11" data-line-number="11"><span class="co">#&gt; 1  2319</span></a></code></pre></div>
<p>Calculate the abundance of trees by species.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" data-line-number="1">by_sp &lt;-<span class="st"> </span><span class="kw">group_by</span>(non_missing, sp)</a>
<a class="sourceLine" id="cb20-2" data-line-number="2">n_by_sp &lt;-<span class="st"> </span><span class="kw">abundance_tree</span>(by_sp)</a>
<a class="sourceLine" id="cb20-3" data-line-number="3">n_by_sp</a>
<a class="sourceLine" id="cb20-4" data-line-number="4"><span class="co">#&gt; # A tibble: 70 x 2</span></a>
<a class="sourceLine" id="cb20-5" data-line-number="5"><span class="co">#&gt;    sp         n</span></a>
<a class="sourceLine" id="cb20-6" data-line-number="6"><span class="co">#&gt;    &lt;chr&gt;  &lt;int&gt;</span></a>
<a class="sourceLine" id="cb20-7" data-line-number="7"><span class="co">#&gt;  1 ALCFLO    11</span></a>
<a class="sourceLine" id="cb20-8" data-line-number="8"><span class="co">#&gt;  2 ALCLAT    15</span></a>
<a class="sourceLine" id="cb20-9" data-line-number="9"><span class="co">#&gt;  3 ANDINE     1</span></a>
<a class="sourceLine" id="cb20-10" data-line-number="10"><span class="co">#&gt;  4 ANTOBT     1</span></a>
<a class="sourceLine" id="cb20-11" data-line-number="11"><span class="co">#&gt;  5 ARDGLA     1</span></a>
<a class="sourceLine" id="cb20-12" data-line-number="12"><span class="co">#&gt;  6 BUCTET    11</span></a>
<a class="sourceLine" id="cb20-13" data-line-number="13"><span class="co">#&gt;  7 BYRSPI    25</span></a>
<a class="sourceLine" id="cb20-14" data-line-number="14"><span class="co">#&gt;  8 CALCAL     2</span></a>
<a class="sourceLine" id="cb20-15" data-line-number="15"><span class="co">#&gt;  9 CASARB   489</span></a>
<a class="sourceLine" id="cb20-16" data-line-number="16"><span class="co">#&gt; 10 CASSYL    58</span></a>
<a class="sourceLine" id="cb20-17" data-line-number="17"><span class="co">#&gt; # ... with 60 more rows</span></a></code></pre></div>
<p>Above you saw that <code>abundance_tree(DATA)</code> and <code>abundance_stem(DATA)</code> generalize to <code>count_distinct(DATA, stemID)</code> and <code>count_distinct(DATA, stemID)</code>. An even greater generalization is <code>count()</code>. <strong>fgeo</strong> borrows the function <code>count()</code> (and some friends) from the <a href="https://dplyr.tidyverse.org/"><strong>dplyr</strong></a> package. Today, <code><a href="http://dplyr.tidyverse.org/reference/tally.html">dplyr::count()</a></code> appears to be the simplest, the most general and powerful tool to count things. <strong>fgeo</strong> imports and reexports <code><a href="http://dplyr.tidyverse.org/reference/tally.html">dplyr::count()</a></code> (and friends) so it’s available when you run <code>library(fgeo)</code>.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" data-line-number="1"><span class="kw"><a href="../reference/fgeo_help.html">fgeo_help</a></span>(<span class="st">"reexports"</span>, <span class="dt">package =</span> <span class="st">"fgeo.abundance"</span>)</a></code></pre></div>
</div>
<div id="picking-the-most-abundant-species" class="section level2">
<h2 class="hasAnchor">
<a href="#picking-the-most-abundant-species" class="anchor"></a>Picking the most abundant species</h2>
<p>Which are the three most abundant tree species?</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" data-line-number="1">top3 &lt;-<span class="st"> </span><span class="kw">pick_top</span>(n_by_sp, n, <span class="dv">-3</span>)</a>
<a class="sourceLine" id="cb22-2" data-line-number="2">top3</a>
<a class="sourceLine" id="cb22-3" data-line-number="3"><span class="co">#&gt; # A tibble: 3 x 2</span></a>
<a class="sourceLine" id="cb22-4" data-line-number="4"><span class="co">#&gt;   sp         n</span></a>
<a class="sourceLine" id="cb22-5" data-line-number="5"><span class="co">#&gt;   &lt;chr&gt;  &lt;int&gt;</span></a>
<a class="sourceLine" id="cb22-6" data-line-number="6"><span class="co">#&gt; 1 CASARB   489</span></a>
<a class="sourceLine" id="cb22-7" data-line-number="7"><span class="co">#&gt; 2 PREMON   507</span></a>
<a class="sourceLine" id="cb22-8" data-line-number="8"><span class="co">#&gt; 3 SCHMOR   151</span></a></code></pre></div>
<p>Now we can subset the <code>alive_trees</code> of only the <code>top3</code> species.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" data-line-number="1">picked_stems &lt;-<span class="st"> </span><span class="kw">subset</span>(alive_trees, sp <span class="op">%in%</span><span class="st"> </span>top3<span class="op">$</span>sp)</a></code></pre></div>
</div>
<div id="mapping-the-distribution-of-tree-species" class="section level2">
<h2 class="hasAnchor">
<a href="#mapping-the-distribution-of-tree-species" class="anchor"></a>Mapping the distribution of tree species</h2>
<p><strong>fgeo</strong> includes some functions specialized in mapping ForestGEO’s data.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" data-line-number="1"><span class="kw"><a href="../reference/fgeo_help.html">fgeo_help</a></span>(<span class="st">"map"</span>)</a></code></pre></div>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" data-line-number="1"><span class="kw">subset</span>(fgeo_funs, <span class="kw">grepl</span>(<span class="st">"map"</span>, fun))</a>
<a class="sourceLine" id="cb25-2" data-line-number="2"><span class="co">#&gt;      package             fun</span></a>
<a class="sourceLine" id="cb25-3" data-line-number="3"><span class="co">#&gt; 90  fgeo.map        map_elev</span></a>
<a class="sourceLine" id="cb25-4" data-line-number="4"><span class="co">#&gt; 91  fgeo.map       map_gx_gy</span></a>
<a class="sourceLine" id="cb25-5" data-line-number="5"><span class="co">#&gt; 92  fgeo.map  map_gx_gy_elev</span></a>
<a class="sourceLine" id="cb25-6" data-line-number="6"><span class="co">#&gt; 93  fgeo.map map_quad_header</span></a>
<a class="sourceLine" id="cb25-7" data-line-number="7"><span class="co">#&gt; 94  fgeo.map     map_sp_elev</span></a>
<a class="sourceLine" id="cb25-8" data-line-number="8"><span class="co">#&gt; 95  fgeo.map  map_tag_header</span></a>
<a class="sourceLine" id="cb25-9" data-line-number="9"><span class="co">#&gt; 96  fgeo.map      maply_quad</span></a>
<a class="sourceLine" id="cb25-10" data-line-number="10"><span class="co">#&gt; 97  fgeo.map   maply_sp_elev</span></a>
<a class="sourceLine" id="cb25-11" data-line-number="11"><span class="co">#&gt; 98  fgeo.map       maply_tag</span></a>
<a class="sourceLine" id="cb25-12" data-line-number="12"><span class="co">#&gt; 101 fgeo.map  theme_map_quad</span></a>
<a class="sourceLine" id="cb25-13" data-line-number="13"><span class="co">#&gt; 102 fgeo.map   theme_map_tag</span></a></code></pre></div>
<p>Map the most abundant species.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" data-line-number="1"><span class="co"># luquillo_elevation comes with fgeo</span></a>
<a class="sourceLine" id="cb26-2" data-line-number="2">p &lt;-<span class="st"> </span><span class="kw">map_sp_elev</span>(picked_stems, <span class="dt">elevation =</span> luquillo_elevation, <span class="dt">point_size =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb26-3" data-line-number="3">p</a></code></pre></div>
<p><img src="fgeo_files/figure-html/unnamed-chunk-22-1.png" width="700"></p>
<p>Tweak to focus on the hectare available in the data.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" data-line-number="1">p1 &lt;-<span class="st"> </span><span class="kw">limit_gx_gy</span>(p, <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">100</span>, <span class="dv">200</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">400</span>, <span class="dv">500</span>))</a>
<a class="sourceLine" id="cb27-2" data-line-number="2"><span class="co">#&gt; Scale for 'x' is already present. Adding another scale for 'x', which</span></a>
<a class="sourceLine" id="cb27-3" data-line-number="3"><span class="co">#&gt; will replace the existing scale.</span></a>
<a class="sourceLine" id="cb27-4" data-line-number="4"><span class="co">#&gt; Scale for 'y' is already present. Adding another scale for 'y', which</span></a>
<a class="sourceLine" id="cb27-5" data-line-number="5"><span class="co">#&gt; will replace the existing scale.</span></a>
<a class="sourceLine" id="cb27-6" data-line-number="6">p1</a></code></pre></div>
<p><img src="fgeo_files/figure-html/unnamed-chunk-23-1.png" width="700"></p>
</div>
<div id="determine-species-habitat-associations" class="section level2">
<h2 class="hasAnchor">
<a href="#determine-species-habitat-associations" class="anchor"></a>Determine species-habitat associations</h2>
<p>Let’s determine the species-habitat associations using a torus translation test.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb28-1" data-line-number="1"><span class="kw"><a href="../reference/fgeo_help.html">fgeo_help</a></span>(<span class="st">"torus"</span>)</a></code></pre></div>
<p>This test should use individual trees not the (potentially multiple) stems of individual trees. This test only makes sense at the population level. We are interested in knowing whether or not individuals of a species are aggregated on a habitat. Multiple stems of an individual do not represent population level processes but individual level processes. Let’s then use a ForestGEO <em>tree</em> table. I’ll use <code>luquillo_tree6_random</code>, which contains a small sample of randomly chosen trees across the entire plot (see <code>?</code>luquillo_tree6_random`).</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb29-1" data-line-number="1">tree &lt;-<span class="st"> </span>luquillo_tree6_random</a></code></pre></div>
<p>I’ll pick alive trees of 10 mm or more (for details see previous sections). The variable <code>status</code> of ‘tree’ tables directly represent the status of each tree (see <code>?census_description</code>). I’ll focus on trees with status “A” (alive).</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" data-line-number="1">dbh10plus &lt;-<span class="st"> </span><span class="kw">pick_dbh_min</span>(tree, <span class="dv">10</span>)</a>
<a class="sourceLine" id="cb30-2" data-line-number="2">chosen_trees &lt;-<span class="st"> </span><span class="kw">pick_status</span>(dbh10plus, <span class="st">"A"</span>)</a>
<a class="sourceLine" id="cb30-3" data-line-number="3"><span class="kw">unique</span>(chosen_trees<span class="op">$</span>status)</a>
<a class="sourceLine" id="cb30-4" data-line-number="4"><span class="co">#&gt; [1] "A"</span></a></code></pre></div>
<p>Note that <code>tt_test()</code> is recommended for sufficiently abundant species:</p>
<blockquote>
<p>You should only try to determine the habitat association for sufficiently abundant species - in a 50-ha plot, a minimum abundance of 50 trees/species has been used.</p>
</blockquote>
<p>– <code>?tt_test()</code></p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb31-1" data-line-number="1"><span class="co"># Find sufficiently abundant species</span></a>
<a class="sourceLine" id="cb31-2" data-line-number="2">by_sp &lt;-<span class="st"> </span><span class="kw">group_by</span>(tree, sp)</a>
<a class="sourceLine" id="cb31-3" data-line-number="3">n_by_sp &lt;-<span class="st"> </span><span class="kw">abundance_tree</span>(by_sp)</a>
<a class="sourceLine" id="cb31-4" data-line-number="4">n_by_sp</a>
<a class="sourceLine" id="cb31-5" data-line-number="5"><span class="co">#&gt; # A tibble: 73 x 2</span></a>
<a class="sourceLine" id="cb31-6" data-line-number="6"><span class="co">#&gt;    sp         n</span></a>
<a class="sourceLine" id="cb31-7" data-line-number="7"><span class="co">#&gt;    &lt;chr&gt;  &lt;int&gt;</span></a>
<a class="sourceLine" id="cb31-8" data-line-number="8"><span class="co">#&gt;  1 ALCFLO     3</span></a>
<a class="sourceLine" id="cb31-9" data-line-number="9"><span class="co">#&gt;  2 ALCLAT     1</span></a>
<a class="sourceLine" id="cb31-10" data-line-number="10"><span class="co">#&gt;  3 ANDINE     2</span></a>
<a class="sourceLine" id="cb31-11" data-line-number="11"><span class="co">#&gt;  4 ARDGLA     2</span></a>
<a class="sourceLine" id="cb31-12" data-line-number="12"><span class="co">#&gt;  5 ARTALT     1</span></a>
<a class="sourceLine" id="cb31-13" data-line-number="13"><span class="co">#&gt;  6 BRUPOR     1</span></a>
<a class="sourceLine" id="cb31-14" data-line-number="14"><span class="co">#&gt;  7 BUCTET     8</span></a>
<a class="sourceLine" id="cb31-15" data-line-number="15"><span class="co">#&gt;  8 BYRSPI    11</span></a>
<a class="sourceLine" id="cb31-16" data-line-number="16"><span class="co">#&gt;  9 CALCAL     1</span></a>
<a class="sourceLine" id="cb31-17" data-line-number="17"><span class="co">#&gt; 10 CASARB    94</span></a>
<a class="sourceLine" id="cb31-18" data-line-number="18"><span class="co">#&gt; # ... with 63 more rows</span></a>
<a class="sourceLine" id="cb31-19" data-line-number="19"></a>
<a class="sourceLine" id="cb31-20" data-line-number="20">n_sp50plus &lt;-<span class="st"> </span><span class="kw">subset</span>(n_by_sp, n <span class="op">&gt;</span><span class="st"> </span><span class="dv">50</span>)</a>
<a class="sourceLine" id="cb31-21" data-line-number="21">n_sp50plus</a>
<a class="sourceLine" id="cb31-22" data-line-number="22"><span class="co">#&gt; # A tibble: 3 x 2</span></a>
<a class="sourceLine" id="cb31-23" data-line-number="23"><span class="co">#&gt;   sp         n</span></a>
<a class="sourceLine" id="cb31-24" data-line-number="24"><span class="co">#&gt;   &lt;chr&gt;  &lt;int&gt;</span></a>
<a class="sourceLine" id="cb31-25" data-line-number="25"><span class="co">#&gt; 1 CASARB    94</span></a>
<a class="sourceLine" id="cb31-26" data-line-number="26"><span class="co">#&gt; 2 PREMON   256</span></a>
<a class="sourceLine" id="cb31-27" data-line-number="27"><span class="co">#&gt; 3 SLOBER    84</span></a></code></pre></div>
<p>We’ll need habitat data. Or at least elevation data – with which to create habitat data with <code>fgeo_habitat()</code>.</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb32-1" data-line-number="1"><span class="co"># See ?luquillo_habitat</span></a>
<a class="sourceLine" id="cb32-2" data-line-number="2">habitat &lt;-<span class="st"> </span>luquillo_habitat</a>
<a class="sourceLine" id="cb32-3" data-line-number="3"><span class="co"># Same</span></a>
<a class="sourceLine" id="cb32-4" data-line-number="4">habitat &lt;-<span class="st"> </span><span class="kw">fgeo_habitat</span>(luquillo_elevation, <span class="dt">gridsize =</span> <span class="dv">20</span>, <span class="dt">n =</span> <span class="dv">4</span>)</a>
<a class="sourceLine" id="cb32-5" data-line-number="5"><span class="kw">str</span>(habitat)</a>
<a class="sourceLine" id="cb32-6" data-line-number="6"><span class="co">#&gt; Classes 'fgeo_habitat', 'tbl_df', 'tbl' and 'data.frame':    6400 obs. of  3 variables:</span></a>
<a class="sourceLine" id="cb32-7" data-line-number="7"><span class="co">#&gt;  $ gx      : int  0 0 0 0 0 0 0 0 0 0 ...</span></a>
<a class="sourceLine" id="cb32-8" data-line-number="8"><span class="co">#&gt;  $ gy      : int  0 5 10 15 20 25 30 35 40 45 ...</span></a>
<a class="sourceLine" id="cb32-9" data-line-number="9"><span class="co">#&gt;  $ habitats: int  1 1 1 1 1 1 1 1 1 1 ...</span></a></code></pre></div>
<p>And now we are ready to run the test.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb33-1" data-line-number="1">tt &lt;-<span class="st"> </span><span class="kw">tt_test</span>(chosen_trees, <span class="dt">sp =</span> n_sp50plus<span class="op">$</span>sp, <span class="dt">habitat =</span> habitat)</a></code></pre></div>
<p>The output of <code>tt_test()</code> is a list. Large lists are awkward to view – unless you use <code>View()</code> in RStudio.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb34-1" data-line-number="1"><span class="kw">View</span>(tt)</a></code></pre></div>
<p>Alternatively, transform the list to a dataframe.</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb35-1" data-line-number="1">tt_df &lt;-<span class="st"> </span><span class="kw">to_df</span>(tt)</a>
<a class="sourceLine" id="cb35-2" data-line-number="2"><span class="co"># Nice view (try also `View()`)</span></a>
<a class="sourceLine" id="cb35-3" data-line-number="3"><span class="kw">as_tibble</span>(tt_df)</a>
<a class="sourceLine" id="cb35-4" data-line-number="4"><span class="co">#&gt; # A tibble: 72 x 3</span></a>
<a class="sourceLine" id="cb35-5" data-line-number="5"><span class="co">#&gt;    metric         sp         value</span></a>
<a class="sourceLine" id="cb35-6" data-line-number="6"><span class="co">#&gt;    &lt;chr&gt;          &lt;chr&gt;      &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb35-7" data-line-number="7"><span class="co">#&gt;  1 N.Hab.1        CASARB    28    </span></a>
<a class="sourceLine" id="cb35-8" data-line-number="8"><span class="co">#&gt;  2 Gr.Hab.1       CASARB 25511    </span></a>
<a class="sourceLine" id="cb35-9" data-line-number="9"><span class="co">#&gt;  3 Ls.Hab.1       CASARB    86    </span></a>
<a class="sourceLine" id="cb35-10" data-line-number="10"><span class="co">#&gt;  4 Eq.Hab.1       CASARB     3    </span></a>
<a class="sourceLine" id="cb35-11" data-line-number="11"><span class="co">#&gt;  5 Rep.Agg.Neut.1 CASARB     1    </span></a>
<a class="sourceLine" id="cb35-12" data-line-number="12"><span class="co">#&gt;  6 Obs.Quantile.1 CASARB     0.997</span></a>
<a class="sourceLine" id="cb35-13" data-line-number="13"><span class="co">#&gt;  7 N.Hab.2        CASARB    12    </span></a>
<a class="sourceLine" id="cb35-14" data-line-number="14"><span class="co">#&gt;  8 Gr.Hab.2       CASARB  3691    </span></a>
<a class="sourceLine" id="cb35-15" data-line-number="15"><span class="co">#&gt;  9 Ls.Hab.2       CASARB 21892    </span></a>
<a class="sourceLine" id="cb35-16" data-line-number="16"><span class="co">#&gt; 10 Eq.Hab.2       CASARB    17    </span></a>
<a class="sourceLine" id="cb35-17" data-line-number="17"><span class="co">#&gt; # ... with 62 more rows</span></a></code></pre></div>
</div>
<div id="krige-soil-data" class="section level2">
<h2 class="hasAnchor">
<a href="#krige-soil-data" class="anchor"></a>Krige soil data</h2>
<p>Let’s Krige soil data.</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb36-1" data-line-number="1"><span class="kw"><a href="../reference/fgeo_help.html">fgeo_help</a></span>(<span class="st">"krig"</span>)</a></code></pre></div>
<p><strong>fgeo</strong> provides a fake soil dataset for examples.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb37-1" data-line-number="1"><span class="kw">str</span>(soil_fake)</a>
<a class="sourceLine" id="cb37-2" data-line-number="2"><span class="co">#&gt; Classes 'tbl_df', 'tbl' and 'data.frame':    30 obs. of  5 variables:</span></a>
<a class="sourceLine" id="cb37-3" data-line-number="3"><span class="co">#&gt;  $ gx: int  40 56 61 67 113 173 239 257 283 294 ...</span></a>
<a class="sourceLine" id="cb37-4" data-line-number="4"><span class="co">#&gt;  $ gy: int  193 30 102 110 16 134 252 442 288 181 ...</span></a>
<a class="sourceLine" id="cb37-5" data-line-number="5"><span class="co">#&gt;  $ mg: num  0.67 0.5 0.65 0.5 0.56 0.74 0.47 0.52 0.45 0.7 ...</span></a>
<a class="sourceLine" id="cb37-6" data-line-number="6"><span class="co">#&gt;  $ c : num  1.75 2.25 2.05 2.35 1.45 1.55 0.85 2.25 0.45 2.45 ...</span></a>
<a class="sourceLine" id="cb37-7" data-line-number="7"><span class="co">#&gt;  $ p : num  6.5 5.9 6.4 6.4 6.2 7 5.9 6.2 6.7 7.1 ...</span></a></code></pre></div>
<p>The data contains multiple soil variables; let’s use only two of them.</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb38-1" data-line-number="1">soil_vars &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">"c"</span>, <span class="st">"p"</span>)</a>
<a class="sourceLine" id="cb38-2" data-line-number="2">krig_list &lt;-<span class="st"> </span><span class="kw">krig</span>(soil_fake, soil_vars, <span class="dt">quiet =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<p>The output is a nested list, which is awkward to view on the console but you can view it in RStudio with <code>View()</code> and summarize it with <code>summary()</code></p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb39-1" data-line-number="1"><span class="kw">summary</span>(krig_list)</a>
<a class="sourceLine" id="cb39-2" data-line-number="2"><span class="co">#&gt; var: c </span></a>
<a class="sourceLine" id="cb39-3" data-line-number="3"><span class="co">#&gt; df</span></a>
<a class="sourceLine" id="cb39-4" data-line-number="4"><span class="co">#&gt; 'data.frame':    1150 obs. of  3 variables:</span></a>
<a class="sourceLine" id="cb39-5" data-line-number="5"><span class="co">#&gt;  $ x: num  10 30 50 70 90 110 130 150 170 190 ...</span></a>
<a class="sourceLine" id="cb39-6" data-line-number="6"><span class="co">#&gt;  $ y: num  10 10 10 10 10 10 10 10 10 10 ...</span></a>
<a class="sourceLine" id="cb39-7" data-line-number="7"><span class="co">#&gt;  $ z: num  2.13 2.12 2.1 2.09 2.07 ...</span></a>
<a class="sourceLine" id="cb39-8" data-line-number="8"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb39-9" data-line-number="9"><span class="co">#&gt; df.poly</span></a>
<a class="sourceLine" id="cb39-10" data-line-number="10"><span class="co">#&gt; 'data.frame':    1150 obs. of  3 variables:</span></a>
<a class="sourceLine" id="cb39-11" data-line-number="11"><span class="co">#&gt;  $ gx: num  10 30 50 70 90 110 130 150 170 190 ...</span></a>
<a class="sourceLine" id="cb39-12" data-line-number="12"><span class="co">#&gt;  $ gy: num  10 10 10 10 10 10 10 10 10 10 ...</span></a>
<a class="sourceLine" id="cb39-13" data-line-number="13"><span class="co">#&gt;  $ z : num  2.13 2.12 2.1 2.09 2.07 ...</span></a>
<a class="sourceLine" id="cb39-14" data-line-number="14"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb39-15" data-line-number="15"><span class="co">#&gt; lambda</span></a>
<a class="sourceLine" id="cb39-16" data-line-number="16"><span class="co">#&gt; 'numeric'</span></a>
<a class="sourceLine" id="cb39-17" data-line-number="17"><span class="co">#&gt;  num 1</span></a>
<a class="sourceLine" id="cb39-18" data-line-number="18"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb39-19" data-line-number="19"><span class="co">#&gt; vg</span></a>
<a class="sourceLine" id="cb39-20" data-line-number="20"><span class="co">#&gt; 'variogram'</span></a>
<a class="sourceLine" id="cb39-21" data-line-number="21"><span class="co">#&gt; List of 20</span></a>
<a class="sourceLine" id="cb39-22" data-line-number="22"><span class="co">#&gt;  $ u               : num [1:9] 60.9 86.5 103 122.7 146.1 ...</span></a>
<a class="sourceLine" id="cb39-23" data-line-number="23"><span class="co">#&gt;  $ v               : num [1:9] 0.284 0.422 0.882 0.543 0.211 ...</span></a>
<a class="sourceLine" id="cb39-24" data-line-number="24"><span class="co">#&gt;  $ n               : num [1:9] 7 9 10 10 18 19 36 34 38</span></a>
<a class="sourceLine" id="cb39-25" data-line-number="25"><span class="co">#&gt;  $ sd              : num [1:9] 0.414 0.48 0.633 0.501 0.405 ...</span></a>
<a class="sourceLine" id="cb39-26" data-line-number="26"><span class="co">#&gt;  $ bins.lim        : num [1:31] 1.00e-12 2.00 2.38 2.84 3.38 ...</span></a>
<a class="sourceLine" id="cb39-27" data-line-number="27"><span class="co">#&gt;  $ ind.bin         : logi [1:30] FALSE FALSE FALSE FALSE FALSE FALSE ...</span></a>
<a class="sourceLine" id="cb39-28" data-line-number="28"><span class="co">#&gt;  $ var.mark        : num 0.317</span></a>
<a class="sourceLine" id="cb39-29" data-line-number="29"><span class="co">#&gt;  $ beta.ols        : num 1.36e-09</span></a>
<a class="sourceLine" id="cb39-30" data-line-number="30"><span class="co">#&gt;  $ output.type     : chr "bin"</span></a>
<a class="sourceLine" id="cb39-31" data-line-number="31"><span class="co">#&gt;  $ max.dist        : num 320</span></a>
<a class="sourceLine" id="cb39-32" data-line-number="32"><span class="co">#&gt;  $ estimator.type  : chr "classical"</span></a>
<a class="sourceLine" id="cb39-33" data-line-number="33"><span class="co">#&gt;  $ n.data          : int 30</span></a>
<a class="sourceLine" id="cb39-34" data-line-number="34"><span class="co">#&gt;  $ lambda          : num 1</span></a>
<a class="sourceLine" id="cb39-35" data-line-number="35"><span class="co">#&gt;  $ trend           : chr "cte"</span></a>
<a class="sourceLine" id="cb39-36" data-line-number="36"><span class="co">#&gt;  $ pairs.min       : num 5</span></a>
<a class="sourceLine" id="cb39-37" data-line-number="37"><span class="co">#&gt;  $ nugget.tolerance: num 1e-12</span></a>
<a class="sourceLine" id="cb39-38" data-line-number="38"><span class="co">#&gt;  $ direction       : chr "omnidirectional"</span></a>
<a class="sourceLine" id="cb39-39" data-line-number="39"><span class="co">#&gt;  $ tolerance       : chr "none"</span></a>
<a class="sourceLine" id="cb39-40" data-line-number="40"><span class="co">#&gt;  $ uvec            : num [1:30] 1 2.19 2.61 3.11 3.7 ...</span></a>
<a class="sourceLine" id="cb39-41" data-line-number="41"><span class="co">#&gt;  $ call            : language variog(geodata = geodata, breaks = breaks, trend = trend, pairs.min = 5)</span></a>
<a class="sourceLine" id="cb39-42" data-line-number="42"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb39-43" data-line-number="43"><span class="co">#&gt; vm</span></a>
<a class="sourceLine" id="cb39-44" data-line-number="44"><span class="co">#&gt; 'variomodel', variofit'</span></a>
<a class="sourceLine" id="cb39-45" data-line-number="45"><span class="co">#&gt; List of 17</span></a>
<a class="sourceLine" id="cb39-46" data-line-number="46"><span class="co">#&gt;  $ nugget               : num 0.352</span></a>
<a class="sourceLine" id="cb39-47" data-line-number="47"><span class="co">#&gt;  $ cov.pars             : num [1:2] 0 160</span></a>
<a class="sourceLine" id="cb39-48" data-line-number="48"><span class="co">#&gt;  $ cov.model            : chr "exponential"</span></a>
<a class="sourceLine" id="cb39-49" data-line-number="49"><span class="co">#&gt;  $ kappa                : num 0.5</span></a>
<a class="sourceLine" id="cb39-50" data-line-number="50"><span class="co">#&gt;  $ value                : num 4.64</span></a>
<a class="sourceLine" id="cb39-51" data-line-number="51"><span class="co">#&gt;  $ trend                : chr "cte"</span></a>
<a class="sourceLine" id="cb39-52" data-line-number="52"><span class="co">#&gt;  $ beta.ols             : num 1.36e-09</span></a>
<a class="sourceLine" id="cb39-53" data-line-number="53"><span class="co">#&gt;  $ practicalRange       : num 480</span></a>
<a class="sourceLine" id="cb39-54" data-line-number="54"><span class="co">#&gt;  $ max.dist             : num 320</span></a>
<a class="sourceLine" id="cb39-55" data-line-number="55"><span class="co">#&gt;  $ minimisation.function: chr "optim"</span></a>
<a class="sourceLine" id="cb39-56" data-line-number="56"><span class="co">#&gt;  $ weights              : chr "npairs"</span></a>
<a class="sourceLine" id="cb39-57" data-line-number="57"><span class="co">#&gt;  $ method               : chr "WLS"</span></a>
<a class="sourceLine" id="cb39-58" data-line-number="58"><span class="co">#&gt;  $ fix.nugget           : logi FALSE</span></a>
<a class="sourceLine" id="cb39-59" data-line-number="59"><span class="co">#&gt;  $ fix.kappa            : logi TRUE</span></a>
<a class="sourceLine" id="cb39-60" data-line-number="60"><span class="co">#&gt;  $ lambda               : num 1</span></a>
<a class="sourceLine" id="cb39-61" data-line-number="61"><span class="co">#&gt;  $ message              : chr "optim convergence code: 0"</span></a>
<a class="sourceLine" id="cb39-62" data-line-number="62"><span class="co">#&gt;  $ call                 : language variofit(vario = vg, ini.cov.pars = c(initialVal, startRange), cov.model = varModels[i],      nugget = initialVal)</span></a>
<a class="sourceLine" id="cb39-63" data-line-number="63"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb39-64" data-line-number="64"><span class="co">#&gt; var: p </span></a>
<a class="sourceLine" id="cb39-65" data-line-number="65"><span class="co">#&gt; df</span></a>
<a class="sourceLine" id="cb39-66" data-line-number="66"><span class="co">#&gt; 'data.frame':    1150 obs. of  3 variables:</span></a>
<a class="sourceLine" id="cb39-67" data-line-number="67"><span class="co">#&gt;  $ x: num  10 30 50 70 90 110 130 150 170 190 ...</span></a>
<a class="sourceLine" id="cb39-68" data-line-number="68"><span class="co">#&gt;  $ y: num  10 10 10 10 10 10 10 10 10 10 ...</span></a>
<a class="sourceLine" id="cb39-69" data-line-number="69"><span class="co">#&gt;  $ z: num  6.37 6.35 6.33 6.31 6.29 ...</span></a>
<a class="sourceLine" id="cb39-70" data-line-number="70"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb39-71" data-line-number="71"><span class="co">#&gt; df.poly</span></a>
<a class="sourceLine" id="cb39-72" data-line-number="72"><span class="co">#&gt; 'data.frame':    1150 obs. of  3 variables:</span></a>
<a class="sourceLine" id="cb39-73" data-line-number="73"><span class="co">#&gt;  $ gx: num  10 30 50 70 90 110 130 150 170 190 ...</span></a>
<a class="sourceLine" id="cb39-74" data-line-number="74"><span class="co">#&gt;  $ gy: num  10 10 10 10 10 10 10 10 10 10 ...</span></a>
<a class="sourceLine" id="cb39-75" data-line-number="75"><span class="co">#&gt;  $ z : num  6.37 6.35 6.33 6.31 6.29 ...</span></a>
<a class="sourceLine" id="cb39-76" data-line-number="76"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb39-77" data-line-number="77"><span class="co">#&gt; lambda</span></a>
<a class="sourceLine" id="cb39-78" data-line-number="78"><span class="co">#&gt; 'numeric'</span></a>
<a class="sourceLine" id="cb39-79" data-line-number="79"><span class="co">#&gt;  num 1</span></a>
<a class="sourceLine" id="cb39-80" data-line-number="80"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb39-81" data-line-number="81"><span class="co">#&gt; vg</span></a>
<a class="sourceLine" id="cb39-82" data-line-number="82"><span class="co">#&gt; 'variogram'</span></a>
<a class="sourceLine" id="cb39-83" data-line-number="83"><span class="co">#&gt; List of 20</span></a>
<a class="sourceLine" id="cb39-84" data-line-number="84"><span class="co">#&gt;  $ u               : num [1:9] 60.9 86.5 103 122.7 146.1 ...</span></a>
<a class="sourceLine" id="cb39-85" data-line-number="85"><span class="co">#&gt;  $ v               : num [1:9] 0.396 0.4 0.11 0.402 0.385 ...</span></a>
<a class="sourceLine" id="cb39-86" data-line-number="86"><span class="co">#&gt;  $ n               : num [1:9] 7 9 10 10 18 19 36 34 38</span></a>
<a class="sourceLine" id="cb39-87" data-line-number="87"><span class="co">#&gt;  $ sd              : num [1:9] 0.592 0.414 0.133 0.409 0.488 ...</span></a>
<a class="sourceLine" id="cb39-88" data-line-number="88"><span class="co">#&gt;  $ bins.lim        : num [1:31] 1.00e-12 2.00 2.38 2.84 3.38 ...</span></a>
<a class="sourceLine" id="cb39-89" data-line-number="89"><span class="co">#&gt;  $ ind.bin         : logi [1:30] FALSE FALSE FALSE FALSE FALSE FALSE ...</span></a>
<a class="sourceLine" id="cb39-90" data-line-number="90"><span class="co">#&gt;  $ var.mark        : num 0.267</span></a>
<a class="sourceLine" id="cb39-91" data-line-number="91"><span class="co">#&gt;  $ beta.ols        : num -3.14e-09</span></a>
<a class="sourceLine" id="cb39-92" data-line-number="92"><span class="co">#&gt;  $ output.type     : chr "bin"</span></a>
<a class="sourceLine" id="cb39-93" data-line-number="93"><span class="co">#&gt;  $ max.dist        : num 320</span></a>
<a class="sourceLine" id="cb39-94" data-line-number="94"><span class="co">#&gt;  $ estimator.type  : chr "classical"</span></a>
<a class="sourceLine" id="cb39-95" data-line-number="95"><span class="co">#&gt;  $ n.data          : int 30</span></a>
<a class="sourceLine" id="cb39-96" data-line-number="96"><span class="co">#&gt;  $ lambda          : num 1</span></a>
<a class="sourceLine" id="cb39-97" data-line-number="97"><span class="co">#&gt;  $ trend           : chr "cte"</span></a>
<a class="sourceLine" id="cb39-98" data-line-number="98"><span class="co">#&gt;  $ pairs.min       : num 5</span></a>
<a class="sourceLine" id="cb39-99" data-line-number="99"><span class="co">#&gt;  $ nugget.tolerance: num 1e-12</span></a>
<a class="sourceLine" id="cb39-100" data-line-number="100"><span class="co">#&gt;  $ direction       : chr "omnidirectional"</span></a>
<a class="sourceLine" id="cb39-101" data-line-number="101"><span class="co">#&gt;  $ tolerance       : chr "none"</span></a>
<a class="sourceLine" id="cb39-102" data-line-number="102"><span class="co">#&gt;  $ uvec            : num [1:30] 1 2.19 2.61 3.11 3.7 ...</span></a>
<a class="sourceLine" id="cb39-103" data-line-number="103"><span class="co">#&gt;  $ call            : language variog(geodata = geodata, breaks = breaks, trend = trend, pairs.min = 5)</span></a>
<a class="sourceLine" id="cb39-104" data-line-number="104"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb39-105" data-line-number="105"><span class="co">#&gt; vm</span></a>
<a class="sourceLine" id="cb39-106" data-line-number="106"><span class="co">#&gt; 'variomodel', variofit'</span></a>
<a class="sourceLine" id="cb39-107" data-line-number="107"><span class="co">#&gt; List of 17</span></a>
<a class="sourceLine" id="cb39-108" data-line-number="108"><span class="co">#&gt;  $ nugget               : num 0.305</span></a>
<a class="sourceLine" id="cb39-109" data-line-number="109"><span class="co">#&gt;  $ cov.pars             : num [1:2] 0 160</span></a>
<a class="sourceLine" id="cb39-110" data-line-number="110"><span class="co">#&gt;  $ cov.model            : chr "exponential"</span></a>
<a class="sourceLine" id="cb39-111" data-line-number="111"><span class="co">#&gt;  $ kappa                : num 0.5</span></a>
<a class="sourceLine" id="cb39-112" data-line-number="112"><span class="co">#&gt;  $ value                : num 0.818</span></a>
<a class="sourceLine" id="cb39-113" data-line-number="113"><span class="co">#&gt;  $ trend                : chr "cte"</span></a>
<a class="sourceLine" id="cb39-114" data-line-number="114"><span class="co">#&gt;  $ beta.ols             : num -3.14e-09</span></a>
<a class="sourceLine" id="cb39-115" data-line-number="115"><span class="co">#&gt;  $ practicalRange       : num 479</span></a>
<a class="sourceLine" id="cb39-116" data-line-number="116"><span class="co">#&gt;  $ max.dist             : num 320</span></a>
<a class="sourceLine" id="cb39-117" data-line-number="117"><span class="co">#&gt;  $ minimisation.function: chr "optim"</span></a>
<a class="sourceLine" id="cb39-118" data-line-number="118"><span class="co">#&gt;  $ weights              : chr "npairs"</span></a>
<a class="sourceLine" id="cb39-119" data-line-number="119"><span class="co">#&gt;  $ method               : chr "WLS"</span></a>
<a class="sourceLine" id="cb39-120" data-line-number="120"><span class="co">#&gt;  $ fix.nugget           : logi FALSE</span></a>
<a class="sourceLine" id="cb39-121" data-line-number="121"><span class="co">#&gt;  $ fix.kappa            : logi TRUE</span></a>
<a class="sourceLine" id="cb39-122" data-line-number="122"><span class="co">#&gt;  $ lambda               : num 1</span></a>
<a class="sourceLine" id="cb39-123" data-line-number="123"><span class="co">#&gt;  $ message              : chr "optim convergence code: 0"</span></a>
<a class="sourceLine" id="cb39-124" data-line-number="124"><span class="co">#&gt;  $ call                 : language variofit(vario = vg, ini.cov.pars = c(initialVal, startRange), cov.model = varModels[i],      nugget = initialVal)</span></a></code></pre></div>
<p>Also you can pull a dataframe containing the results of all the soil variables.</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb40-1" data-line-number="1">krig_df &lt;-<span class="st"> </span><span class="kw">to_df</span>(krig_list, <span class="dt">item =</span> <span class="st">"df"</span>)</a>
<a class="sourceLine" id="cb40-2" data-line-number="2"><span class="kw">as_tibble</span>(<span class="kw">subset</span>(krig_df,var <span class="op">==</span><span class="st"> "c"</span>))</a>
<a class="sourceLine" id="cb40-3" data-line-number="3"><span class="co">#&gt; # A tibble: 1,150 x 4</span></a>
<a class="sourceLine" id="cb40-4" data-line-number="4"><span class="co">#&gt;    var       x     y     z</span></a>
<a class="sourceLine" id="cb40-5" data-line-number="5"><span class="co">#&gt;  * &lt;fct&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb40-6" data-line-number="6"><span class="co">#&gt;  1 c        10    10  2.13</span></a>
<a class="sourceLine" id="cb40-7" data-line-number="7"><span class="co">#&gt;  2 c        30    10  2.12</span></a>
<a class="sourceLine" id="cb40-8" data-line-number="8"><span class="co">#&gt;  3 c        50    10  2.10</span></a>
<a class="sourceLine" id="cb40-9" data-line-number="9"><span class="co">#&gt;  4 c        70    10  2.09</span></a>
<a class="sourceLine" id="cb40-10" data-line-number="10"><span class="co">#&gt;  5 c        90    10  2.07</span></a>
<a class="sourceLine" id="cb40-11" data-line-number="11"><span class="co">#&gt;  6 c       110    10  2.06</span></a>
<a class="sourceLine" id="cb40-12" data-line-number="12"><span class="co">#&gt;  7 c       130    10  2.04</span></a>
<a class="sourceLine" id="cb40-13" data-line-number="13"><span class="co">#&gt;  8 c       150    10  2.03</span></a>
<a class="sourceLine" id="cb40-14" data-line-number="14"><span class="co">#&gt;  9 c       170    10  2.01</span></a>
<a class="sourceLine" id="cb40-15" data-line-number="15"><span class="co">#&gt; 10 c       190    10  2.00</span></a>
<a class="sourceLine" id="cb40-16" data-line-number="16"><span class="co">#&gt; # ... with 1,140 more rows</span></a>
<a class="sourceLine" id="cb40-17" data-line-number="17"></a>
<a class="sourceLine" id="cb40-18" data-line-number="18"><span class="kw">as_tibble</span>(<span class="kw">subset</span>(krig_df, var <span class="op">==</span><span class="st"> "p"</span>))</a>
<a class="sourceLine" id="cb40-19" data-line-number="19"><span class="co">#&gt; # A tibble: 1,150 x 4</span></a>
<a class="sourceLine" id="cb40-20" data-line-number="20"><span class="co">#&gt;    var       x     y     z</span></a>
<a class="sourceLine" id="cb40-21" data-line-number="21"><span class="co">#&gt;  * &lt;fct&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb40-22" data-line-number="22"><span class="co">#&gt;  1 p        10    10  6.37</span></a>
<a class="sourceLine" id="cb40-23" data-line-number="23"><span class="co">#&gt;  2 p        30    10  6.35</span></a>
<a class="sourceLine" id="cb40-24" data-line-number="24"><span class="co">#&gt;  3 p        50    10  6.33</span></a>
<a class="sourceLine" id="cb40-25" data-line-number="25"><span class="co">#&gt;  4 p        70    10  6.31</span></a>
<a class="sourceLine" id="cb40-26" data-line-number="26"><span class="co">#&gt;  5 p        90    10  6.29</span></a>
<a class="sourceLine" id="cb40-27" data-line-number="27"><span class="co">#&gt;  6 p       110    10  6.27</span></a>
<a class="sourceLine" id="cb40-28" data-line-number="28"><span class="co">#&gt;  7 p       130    10  6.26</span></a>
<a class="sourceLine" id="cb40-29" data-line-number="29"><span class="co">#&gt;  8 p       150    10  6.24</span></a>
<a class="sourceLine" id="cb40-30" data-line-number="30"><span class="co">#&gt;  9 p       170    10  6.23</span></a>
<a class="sourceLine" id="cb40-31" data-line-number="31"><span class="co">#&gt; 10 p       190    10  6.21</span></a>
<a class="sourceLine" id="cb40-32" data-line-number="32"><span class="co">#&gt; # ... with 1,140 more rows</span></a></code></pre></div>
</div>
<div id="demography" class="section level1">
<h1 class="hasAnchor">
<a href="#demography" class="anchor"></a>Demography</h1>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb41-1" data-line-number="1"><span class="kw"><a href="../reference/fgeo_help.html">fgeo_help</a></span>(<span class="st">"mortality"</span>)</a></code></pre></div>
<p>The primary input of demography functions (<code>recruitment()</code>, <code>mortality()</code> and <code>growth()</code>) is a list of two ForestGEO tree-tables.</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb42-1" data-line-number="1">censuses &lt;-<span class="st"> </span><span class="kw">list</span>(</a>
<a class="sourceLine" id="cb42-2" data-line-number="2"> fgeo.data<span class="op">::</span>luquillo_tree5_random,</a>
<a class="sourceLine" id="cb42-3" data-line-number="3"> fgeo.data<span class="op">::</span>luquillo_tree6_random</a>
<a class="sourceLine" id="cb42-4" data-line-number="4">)</a>
<a class="sourceLine" id="cb42-5" data-line-number="5"></a>
<a class="sourceLine" id="cb42-6" data-line-number="6"><span class="kw">recruitment</span>(censuses, <span class="dt">quiet =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb42-7" data-line-number="7"><span class="co">#&gt; # A tibble: 8 x 2</span></a>
<a class="sourceLine" id="cb42-8" data-line-number="8"><span class="co">#&gt;   metric       value</span></a>
<a class="sourceLine" id="cb42-9" data-line-number="9"><span class="co">#&gt;   &lt;chr&gt;        &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb42-10" data-line-number="10"><span class="co">#&gt; 1 N2       809      </span></a>
<a class="sourceLine" id="cb42-11" data-line-number="11"><span class="co">#&gt; 2 R         43      </span></a>
<a class="sourceLine" id="cb42-12" data-line-number="12"><span class="co">#&gt; 3 rate       0.0121 </span></a>
<a class="sourceLine" id="cb42-13" data-line-number="13"><span class="co">#&gt; 4 lower      0.00895</span></a>
<a class="sourceLine" id="cb42-14" data-line-number="14"><span class="co">#&gt; 5 upper      0.0162 </span></a>
<a class="sourceLine" id="cb42-15" data-line-number="15"><span class="co">#&gt; 6 time       4.53   </span></a>
<a class="sourceLine" id="cb42-16" data-line-number="16"><span class="co">#&gt; 7 date1  15286.     </span></a>
<a class="sourceLine" id="cb42-17" data-line-number="17"><span class="co">#&gt; 8 date2  16941.</span></a></code></pre></div>
<p>Optionally, you can provide any number of variables to group by.</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb43-1" data-line-number="1"><span class="co"># Picking only some species and some quadrats</span></a>
<a class="sourceLine" id="cb43-2" data-line-number="2">smaller &lt;-<span class="st"> </span><span class="kw">lapply</span>(censuses, pick_top, sp, <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb43-3" data-line-number="3">smaller &lt;-<span class="st"> </span><span class="kw">lapply</span>(smaller, pick_top, quadrat, <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb43-4" data-line-number="4"></a>
<a class="sourceLine" id="cb43-5" data-line-number="5">by_sp_quad &lt;-<span class="st"> </span><span class="kw">mortality</span>(smaller, sp, quadrat, <span class="dt">quiet =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb43-6" data-line-number="6"><span class="kw">subset</span>(by_sp_quad, sp <span class="op">==</span><span class="st"> "ALCFLO"</span>)</a>
<a class="sourceLine" id="cb43-7" data-line-number="7"><span class="co">#&gt; # A tibble: 18 x 4</span></a>
<a class="sourceLine" id="cb43-8" data-line-number="8"><span class="co">#&gt; # Groups:   sp [1]</span></a>
<a class="sourceLine" id="cb43-9" data-line-number="9"><span class="co">#&gt;    sp     quadrat metric      value</span></a>
<a class="sourceLine" id="cb43-10" data-line-number="10"><span class="co">#&gt;    &lt;chr&gt;  &lt;chr&gt;   &lt;chr&gt;       &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb43-11" data-line-number="11"><span class="co">#&gt;  1 ALCFLO 518     N           2    </span></a>
<a class="sourceLine" id="cb43-12" data-line-number="12"><span class="co">#&gt;  2 ALCFLO 518     D           0    </span></a>
<a class="sourceLine" id="cb43-13" data-line-number="13"><span class="co">#&gt;  3 ALCFLO 518     rate        0    </span></a>
<a class="sourceLine" id="cb43-14" data-line-number="14"><span class="co">#&gt;  4 ALCFLO 518     lower       0    </span></a>
<a class="sourceLine" id="cb43-15" data-line-number="15"><span class="co">#&gt;  5 ALCFLO 518     upper       0.272</span></a>
<a class="sourceLine" id="cb43-16" data-line-number="16"><span class="co">#&gt;  6 ALCFLO 518     time        4.52 </span></a>
<a class="sourceLine" id="cb43-17" data-line-number="17"><span class="co">#&gt;  7 ALCFLO 518     date1   15345    </span></a>
<a class="sourceLine" id="cb43-18" data-line-number="18"><span class="co">#&gt;  8 ALCFLO 518     date2   16997    </span></a>
<a class="sourceLine" id="cb43-19" data-line-number="19"><span class="co">#&gt;  9 ALCFLO 518     dbhmean   140    </span></a>
<a class="sourceLine" id="cb43-20" data-line-number="20"><span class="co">#&gt; 10 ALCFLO 820     N           2    </span></a>
<a class="sourceLine" id="cb43-21" data-line-number="21"><span class="co">#&gt; 11 ALCFLO 820     D           0    </span></a>
<a class="sourceLine" id="cb43-22" data-line-number="22"><span class="co">#&gt; 12 ALCFLO 820     rate        0    </span></a>
<a class="sourceLine" id="cb43-23" data-line-number="23"><span class="co">#&gt; 13 ALCFLO 820     lower       0    </span></a>
<a class="sourceLine" id="cb43-24" data-line-number="24"><span class="co">#&gt; 14 ALCFLO 820     upper       0.272</span></a>
<a class="sourceLine" id="cb43-25" data-line-number="25"><span class="co">#&gt; 15 ALCFLO 820     time        4.52 </span></a>
<a class="sourceLine" id="cb43-26" data-line-number="26"><span class="co">#&gt; 16 ALCFLO 820     date1   15345    </span></a>
<a class="sourceLine" id="cb43-27" data-line-number="27"><span class="co">#&gt; 17 ALCFLO 820     date2   16997    </span></a>
<a class="sourceLine" id="cb43-28" data-line-number="28"><span class="co">#&gt; 18 ALCFLO 820     dbhmean   140</span></a>
<a class="sourceLine" id="cb43-29" data-line-number="29"><span class="kw">subset</span>(by_sp_quad, quadrat <span class="op">==</span><span class="st"> "914"</span>)</a>
<a class="sourceLine" id="cb43-30" data-line-number="30"><span class="co">#&gt; # A tibble: 0 x 4</span></a>
<a class="sourceLine" id="cb43-31" data-line-number="31"><span class="co">#&gt; # Groups:   sp [0]</span></a>
<a class="sourceLine" id="cb43-32" data-line-number="32"><span class="co">#&gt; # ... with 4 variables: sp &lt;chr&gt;, quadrat &lt;chr&gt;, metric &lt;chr&gt;, value &lt;dbl&gt;</span></a></code></pre></div>
<p>Consider using <code>View()</code> or <code>subset()</code> to focus on specific data.</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb44-1" data-line-number="1"><span class="kw">subset</span>(<span class="kw">subset</span>(by_sp_quad, sp <span class="op">==</span><span class="st"> "ALCLAT"</span>), quadrat <span class="op">==</span><span class="st"> "914"</span>)</a>
<a class="sourceLine" id="cb44-2" data-line-number="2"><span class="co">#&gt; # A tibble: 0 x 4</span></a>
<a class="sourceLine" id="cb44-3" data-line-number="3"><span class="co">#&gt; # Groups:   sp [0]</span></a>
<a class="sourceLine" id="cb44-4" data-line-number="4"><span class="co">#&gt; # ... with 4 variables: sp &lt;chr&gt;, quadrat &lt;chr&gt;, metric &lt;chr&gt;, value &lt;dbl&gt;</span></a></code></pre></div>
<p>You may rearrange the output with <code><a href="http://www.rdocumentation.org/packages/tidyr/topics/spread">tidyr::spread()</a></code>. For example, to show one column per quadrat you would use <code><a href="http://www.rdocumentation.org/packages/tidyr/topics/spread">tidyr::spread(by_sp_quad, quadrat, value)</a></code>.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#packages">Packages</a></li>
      <li><a href="#data">Data</a></li>
      <li><a href="#exploring-the-distribution-of-status-and-tree-diameter">Exploring the distribution of status and tree diameter</a></li>
      <li><a href="#determining-tree-status-based-on-stem-status">Determining tree status based on stem status</a></li>
      <li><a href="#picking-a-dbh-range">Picking a <code>dbh</code> range</a></li>
      <li><a href="#dropping-missing-values">Dropping missing values</a></li>
      <li><a href="#calculating-abundance">Calculating abundance</a></li>
      <li><a href="#picking-the-most-abundant-species">Picking the most abundant species</a></li>
      <li><a href="#mapping-the-distribution-of-tree-species">Mapping the distribution of tree species</a></li>
      <li><a href="#determine-species-habitat-associations">Determine species-habitat associations</a></li>
      <li><a href="#krige-soil-data">Krige soil data</a></li>
      <li><a href="#demography">Demography</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by <a href="https://github.com/maurolepore">Mauro Lepore</a>, <a href="http://www.forestgeo.si.edu/">CTFS-ForestGEO</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.js"></script><script>
  docsearch({
    
    
    apiKey: 'ec79b1c00aff9cd841703edc746e1a71',
    indexName: 'fgeo',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>
</body>
</html>
